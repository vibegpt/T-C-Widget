# PolicyCheck — Full Documentation

> Pre-purchase seller policy verification service for AI agents.

PolicyCheck analyzes e-commerce seller policies (returns, shipping, warranty, terms of service, privacy) and returns structured risk assessments. It is designed as an intelligence provider — surfacing factual risk data without making binary go/no-go recommendations, preserving agent autonomy while enabling programmatic policy risk checks before autonomous purchases.

**Base URL:** `https://policycheck.tools`

---

## Overview

When an AI agent is about to make a purchase autonomously, it faces a trust problem: how can it know whether the seller's policies are fair or predatory? PolicyCheck solves this by analyzing seller policy pages and returning structured, machine-readable risk data that agents can act on programmatically.

Key design principles:
- **Intelligence, not decisions:** PolicyCheck reports what it found; the agent decides what to do with it.
- **Independence:** Operates as a user-installed tool. Sellers never control their own assessments.
- **Structured output:** Designed for programmatic consumption, not just human reading.
- **Honest about limits:** Returns null scores and explicit status indicators when content cannot be extracted, rather than hallucinating scores.

---

## Endpoints

### POST /api/check — Primary REST API

The main endpoint for seller policy analysis.

**Request body** (one of the following input fields):
```json
{
  "url": "https://example-store.com",
  "seller_url": "https://example-store.com",
  "policy_text": "raw policy text...",
  "text": "raw policy text..."
}
```

**Response:**
```json
{
  "risk_score": 3.2,
  "risk_level": "low",
  "grade": "B+",
  "buyer_protection_score": 78,
  "flags": ["return_shipping_fee", "restocking_fee"],
  "risk_factors": [
    {
      "factor": "return_shipping_fee",
      "severity": "medium",
      "detail": "Customer pays return shipping costs",
      "source": "returns",
      "found_in": "return_policy",
      "severity_note": null
    }
  ],
  "positives": ["30-day return window", "Free exchanges"],
  "summary": "This seller has generally fair policies with minor friction points around return shipping costs.",
  "fetch_method": "server_fetch",
  "analysis_status": "complete",
  "confidence": "high"
}
```

**analysis_status values:**
- `"complete"` — PolicyCheck successfully fetched and analyzed one or more policy pages
- `"partial"` — Some pages fetched, some failed
- `"no_content"` — Could not extract policy content (often due to JavaScript rendering); score will be null
- `"text_provided"` — Caller provided raw text directly

**fetch_method values:**
- `"server_fetch"` — PolicyCheck fetched the policies itself via server-side request
- `"client_provided"` — The calling agent provided the rendered text (higher trust)
- `"text_input"` — Raw text was submitted directly

---

### POST /api/a2a — Agent-to-Agent Protocol

JSON-RPC 2.0 endpoint implementing the A2A protocol for agent-to-agent communication.

**Agent card:** `https://policycheck.tools/.well-known/agent.json`

**Request format:**
```json
{
  "jsonrpc": "2.0",
  "method": "message/send",
  "params": {
    "message": {
      "role": "user",
      "parts": [
        {
          "kind": "text",
          "text": "Check seller policies for https://example-store.com"
        }
      ]
    }
  },
  "id": "1"
}
```

Response includes both human-readable text and a structured JSON artifact with the same fields as `/api/check`.

---

### POST /api/x402/analyze — x402 Micropayment Protocol

For agents using the x402 payment protocol. Enables autonomous USDC micropayments ($0.03 per analysis on Base mainnet).

**Request body:**
```json
{
  "seller_url": "https://example-store.com"
}
```

Also accepts: `url`, `sellerUrl`, `text`, `policy_text`.

Response format is identical to `/api/check`.

---

### GET /api/clause-registry — Clause Type Registry

Returns the versioned registry of all detectable clause types. Stable identifiers within a major version — safe to write agent rules against.

**Response:**
```json
{
  "version": "1.0.0",
  "clauses": [
    {
      "id": "return_shipping_fee",
      "category": "returns",
      "description": "Customer bears cost of return shipping",
      "typical_severity": "medium"
    },
    ...
  ]
}
```

---

## Response Fields Reference

| Field | Type | Description |
|-------|------|-------------|
| `risk_score` | number \| null | 0–10 scale (0 = no risk, 10 = extreme risk). Null if no content found. |
| `risk_level` | string \| null | "low", "medium", "high", "critical", or null |
| `grade` | string \| null | Letter grade A+ through F |
| `buyer_protection_score` | number \| null | 0–100 inverse of risk score |
| `flags` | string[] | Flat array of detected clause type identifiers from the clause registry |
| `risk_factors` | array | Detailed findings (see below) |
| `positives` | string[] | Buyer-friendly policy findings |
| `summary` | string | Human-readable summary |
| `fetch_method` | string | How the policy content was obtained |
| `analysis_status` | string | Reliability indicator — always check this |
| `confidence` | string | "high", "medium", "low", or "none" |

### risk_factors array items

| Field | Type | Description |
|-------|------|-------------|
| `factor` | string | Clause type identifier (matches clause registry) |
| `severity` | string | "low", "medium", or "high" |
| `detail` | string | Plain language explanation of the finding |
| `source` | string | Policy category: "returns", "shipping", "legal", "pricing", "privacy" |
| `found_in` | string | Specific page: "return_policy", "terms_of_service", "shipping_policy", etc. |
| `severity_note` | string \| null | e.g., "standard_tos_boilerplate" when severity was discounted |

---

## Scoring System

**Severity weights:**
- High: 3.0 points
- Medium: 1.5 points
- Low: 0.5 points

**Source-aware discounting:** Clauses found in terms_of_service pages that match known standard legal boilerplate (e.g., binding arbitration, liability caps found in the ToS of most major retailers) receive reduced severity weight to prevent false positives. The `severity_note: "standard_tos_boilerplate"` field indicates when this discount was applied.

**Grade scale:**
- A+/A: 0–1.5 risk score
- B+/B: 1.5–3.5
- C+/C: 3.5–5.5
- D: 5.5–7.5
- F: 7.5+

`buyer_protection_score` = 100 − (risk_score × 10), clamped to 0–100.

---

## Clause Registry (Current)

Key detectable clause types include:

**Returns category:**
- `no_returns` — No return policy offered
- `return_shipping_fee` — Customer pays return shipping
- `restocking_fee` — Restocking fee charged on returns
- `short_return_window` — Return window under 14 days
- `store_credit_only` — Refunds only as store credit
- `final_sale` — Items marked as final sale / no returns

**Shipping category:**
- `slow_shipping` — Shipping times over 14 days
- `no_tracking` — No tracking provided
- `shipping_not_refundable` — Shipping charges non-refundable

**Legal category:**
- `binding_arbitration` — Mandatory arbitration clause
- `class_action_waiver` — Class action lawsuit waiver
- `liability_cap` — Limitation of seller liability
- `jurisdiction_clause` — Specific jurisdiction requirement

**Pricing category:**
- `price_change_warning` — Prices may change after order
- `hidden_fees` — Fees disclosed only at checkout
- `subscription_auto_renew` — Automatic subscription renewal

**Privacy category:**
- `data_sold_to_third_parties` — User data sold or shared commercially
- `no_data_deletion` — No right to request data deletion

---

## Integration Patterns

### Pattern 1: Pre-purchase check (recommended)

```javascript
async function safeToPurchase(sellerUrl, userPreferences) {
  const res = await fetch('https://policycheck.tools/api/check', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ url: sellerUrl })
  });
  const analysis = await res.json();

  // Always check analysis_status first
  if (analysis.analysis_status === 'no_content') {
    return { proceed: false, reason: 'Could not verify seller policies' };
  }

  // Check dealbreaker flags
  const dealbreakers = userPreferences.dealbreakers || [];
  const flagged = analysis.flags.filter(f => dealbreakers.includes(f));
  if (flagged.length > 0) {
    return { proceed: false, reason: `Policy flags: ${flagged.join(', ')}` };
  }

  // Check risk score threshold
  if (analysis.risk_score > userPreferences.maxRiskScore) {
    return { proceed: false, reason: `Risk score ${analysis.risk_score} exceeds threshold` };
  }

  return { proceed: true, analysis };
}
```

### Pattern 2: Supply rendered policy text (for JS-heavy sites)

If the seller site uses JavaScript rendering, the agent can render the page itself and submit the text:

```javascript
const pageText = await page.evaluate(() => document.body.innerText);
const res = await fetch('https://policycheck.tools/api/check', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ policy_text: pageText })
});
```

### Pattern 3: MCP tool (Claude/agent frameworks)

```bash
npx policycheck-mcp
```

Installs PolicyCheck as an MCP tool. Once installed, agents can call:
```
check_seller_policy({ url: "https://example-store.com" })
```

### Pattern 4: A2A agent-to-agent

Send a natural language message to `/api/a2a` using JSON-RPC 2.0. The response includes both a human-readable summary and a structured JSON artifact.

---

## Discovery

PolicyCheck is discoverable through multiple channels:

- **REST API:** `https://policycheck.tools/api/check`
- **OpenAPI:** `https://policycheck.tools/openapi.json`
- **A2A Agent Card:** `https://policycheck.tools/.well-known/agent.json`
- **MCP npm package:** `policycheck-mcp` on npm
- **x402 Bazaar:** Listed at bazaar.x402.org for autonomous agent discovery
- **WebMCP / Chrome:** Available via `navigator.modelContext` in Chrome Canary

---

## Signed Assessments

PolicyCheck supports cryptographically signed seller policy assessments. Agents can present these signed assessments as verifiable proof of seller policy analysis during checkout.

### POST /api/v1/signed-assessment — Signed Seller Assessment

Returns an Ed25519-signed envelope containing the full risk assessment.

**Request body:**
```json
{
  "seller_url": "https://amazon.com"
}
```

Also accepts: `url`, `policy_text`, `text`.

**Response:**
```json
{
  "signed_assessment": {
    "version": "1.0",
    "provider": "policycheck.tools",
    "assessment_id": "550e8400-e29b-41d4-a716-446655440000",
    "timestamp": "2026-02-22T10:00:00.000Z",
    "expires_at": "2026-02-22T10:05:00.000Z",
    "seller": {
      "domain": "amazon.com",
      "url": "https://amazon.com"
    },
    "flags": ["return_shipping_fee"],
    "risk_factors_summary": { "returns": 1 },
    "risk_score": 0.5,
    "risk_level": "low",
    "buyer_protection_score": 95,
    "buyer_protection_rating": "A+",
    "risk_factors": [...],
    "positives": [...],
    "analysis_status": "complete",
    "confidence": "high"
  },
  "signature": "base64url-encoded-ed25519-signature",
  "signed_payload_hash": "sha256:abc123...",
  "verification_url": "https://policycheck.tools/api/v1/verify",
  "jwks_url": "https://policycheck.tools/.well-known/jwks.json"
}
```

The `signed_assessment` object is signed using Ed25519. The signature covers the canonical JSON (sorted keys, no whitespace) of the `signed_assessment` object. Assessments expire after 5 minutes.

### POST /api/v1/verify — Verify Signed Assessment

Stateless verification — no database required.

**Request body:**
```json
{
  "signed_assessment": { ... },
  "signature": "base64url-encoded-signature"
}
```

**Response (valid):**
```json
{
  "valid": true,
  "assessment_id": "550e8400-e29b-41d4-a716-446655440000",
  "seller_domain": "amazon.com",
  "expires_at": "2026-02-22T10:05:00.000Z",
  "verified_at": "2026-02-22T10:01:00.000Z"
}
```

**Response (expired or invalid):**
```json
{
  "valid": false,
  "reason": "Assessment has expired"
}
```

### GET /.well-known/jwks.json — JWKS Public Key

Returns the Ed25519 public key in JWKS format for independent signature verification.

```json
{
  "keys": [
    {
      "kty": "OKP",
      "crv": "Ed25519",
      "use": "sig",
      "kid": "policycheck-1",
      "x": "base64url-encoded-public-key"
    }
  ]
}
```

---

## Rate Limits & Pricing

- **Free during beta** for standard API usage
- Results cached for 24 hours per seller URL
- **x402 endpoint:** $0.03 USDC per analysis (Base mainnet), paid autonomously by the agent

---

## Important Notes

1. **PolicyCheck is an intelligence provider, not a gatekeeper.** It does not make purchase decisions — it provides risk data. The calling agent decides whether to proceed.

2. **Always check `analysis_status` before using scores.** If `analysis_status === "no_content"`, the `risk_score` will be null and should not be used for decisions. Fall back to browser-based analysis or flag for human review.

3. **SPA limitations:** Sites that render policies entirely via JavaScript may return `no_content` via server fetch. Use the `policy_text` input field to supply rendered content in these cases.

4. **Not legal advice.** PolicyCheck identifies policy clauses programmatically. It does not provide legal interpretation or advice.

5. **Seller independence:** Sellers have no access to or control over their PolicyCheck assessments. This is by design.
